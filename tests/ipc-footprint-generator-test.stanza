#use-added-syntax(esir)
defpackage ocdb/ipc-footprint-generator-test :
  import core
  import collections
  import math
  import esir
  import esir/utils
  import esir/gen
  import ocdb/tests/default-harness
  import esir/repl-lib
  import ocdb/generator-utils
  import jitpcb/visualizer
  import ocdb/ipc-footprint-generator
  import ocdb/generic-components
  import ocdb/land-patterns

pcb-component chip :
  pin p[1]
  pin p[2]
  package = {gen-chip-pkg("0402", "nominal", "res", true)}(p[1] => p[1], p[2] => p[2])

pcb-component molded :
  pin p[1]
  pin p[2]
  val fields = [["L-min", 1.95], 
                ["L-max", 2.05], 
                ["W-min", 2.25], 
                ["W-max", 2.35], 
                ["TW-min", 0.45], 
                ["TW-max", 0.55], 
                ["T-min", 0.15], 
                ["T-max", 0.35], 
                ["H", 1.2], 
                ["Type", "res"], 
                ["Density", "nominal"]]
  package = {gen-molded-pkg(fields)}(p[1] => p[1], p[2] => p[2])

pcb-component wirewound :
  pin p[1]
  pin p[2]
  val fields = [["L-min", 1.95], 
                ["L-max", 2.05], 
                ["W-min", 2.25], 
                ["W-max", 2.35], 
                ["TW-min", 0.45], 
                ["TW-max", 0.55], 
                ["T-min", 0.15], 
                ["T-max", 0.35], 
                ["H", 1.2], 
                ["Density", "nominal"]]
  package = {gen-wirewound-pkg(fields)}(p[1] => p[1], p[2] => p[2])
  
pcb-component melf :
  pin p[1]
  pin p[2]
  val fields = [["L-min", 1.95], 
                ["L-max", 2.05], 
                ["W-min", 2.25], 
                ["W-max", 2.35], 
                ["T-min", 0.15], 
                ["T-max", 0.35], 
                ["H", 1.2], 
                ["Type", "res"], 
                ["Density", "nominal"]]
  package = {gen-melf-pkg(fields)}(p[1] => p[1], p[2] => p[2])

pcb-component sodfl :
  pin p[1]
  pin p[2]
  val fields = [["L-min", 1.95], 
                ["L-max", 2.05], 
                ["W-min", 2.25], 
                ["W-max", 2.35], 
                ["T-min", 0.15], 
                ["T-max", 0.35], 
                ["TW-min", 0.45], 
                ["TW-max", 0.55], 
                ["E-min", 0.45], 
                ["E-max", 2.95], 
                ["H", 3.05], 
                ["Type", "res"], 
                ["Density", "nominal"]]
  package = {gen-sodfl-pkg(fields)}(p[1] => p[1], p[2] => p[2])

pcb-component capae :
  pin p[1]
  pin p[2]
  val fields = [["D-min", 0.95], 
                ["D-max", 1.05], 
                ["L-min", 1.95], 
                ["L-max", 2.05], 
                ["W-min", 2.25], 
                ["W-max", 2.35], 
                ["T-min", 0.15], 
                ["T-max", 0.35], 
                ["TW-min", 0.45], 
                ["TW-max", 0.55], 
                ["E-min", 0.45], 
                ["E-max", 2.95], 
                ["H", 3.05], 
                ["Type", "res"], 
                ["Density", "nominal"]]
  package = {gen-sodfl-pkg(fields)}(p[1] => p[1], p[2] => p[2])

pcb-component dfn-2 :
  pin p[1]
  pin p[2]
  val fields = [["L-min", 1.95], 
                ["L-max", 2.05], 
                ["W-min", 0.55], 
                ["W-max", 0.65], 
                ["T1-min", 0.15], 
                ["T1-max", 0.35], 
                ["TW1-min", 0.45], 
                ["TW1-max", 0.55], 
                ["H", 0.45], 
                ["H-s", 2.95], 
                ["S1", 0.75], 
                ["S1-o", 0.375], 
                ["Type", 2], 
                ["Density", "nominal"]]
  package = {gen-dfn-pkg(fields)}(p[1] => p[1], p[2] => p[2])

pcb-component dfn-3 :
  pin p[1]
  pin p[2]
  pin p[3]
  val fields = [["L-min", 1.95], 
                ["L-max", 2.05], 
                ["W-min", 0.55], 
                ["W-max", 0.65], 
                ["T1-min", 0.15], 
                ["T1-max", 0.35], 
                ["TW1-min", 0.05], 
                ["TW1-max", 0.15], 
                ["T2-min", 0.15], 
                ["T2-max", 0.35], 
                ["TW2-min", 0.45], 
                ["TW2-max", 0.55], 
                ["H", 0.45], 
                ["H-s", 2.95], 
                ["S1", 0.75], 
                ["S1-o", 0.375], 
                ["S2", 0.45], 
                ["Type", 3], 
                ["Density", "nominal"]]
  package = {gen-dfn-pkg(fields)}(p[1] => p[1], p[2] => p[2], p[3] => p[3])
  
pcb-component dfn-4 :
  port p : pin[{1 through 4}]
  val fields = [["L-min", 1.95], 
                ["L-max", 2.05], 
                ["W-min", 0.55], 
                ["W-max", 0.65], 
                ["T1-min", 0.15], 
                ["T1-max", 0.35], 
                ["TW1-min", 0.05], 
                ["TW1-max", 0.15], 
                ["H", 0.45], 
                ["H-s", 2.95], 
                ["S1", 0.75], 
                ["S1-o", 0.375], 
                ["S2", 0.45], 
                ["Type", 4], 
                ["Density", "nominal"]]
  package = {gen-dfn-pkg(fields)}(for i in 1 through 4 do : p[i] => p[i])

pcb-component soic :
  port p : pin[{1 through 8}]
  val fields = [["L-min", 1.95], 
                ["L-max", 2.05], 
                ["W-min", 4.55], 
                ["W-max", 4.65], 
                ["T1-min", 0.15], 
                ["T1-max", 0.35], 
                ["TW1-min", 0.05], 
                ["TW1-max", 0.15], 
                ["E-min", 2.95], 
                ["E-max", 3.05], 
                ["H", 0.45], 
                ["H-s", 2.95], 
                ["Pin-n", 8], 
                ["THW-min", 3.25],
                ["THW-max", 3.25],
                ["THL-min", 0.45],
                ["THL-max", 0.45],
                ["Pad-shape", "rectangular"], 
                ["Density", "nominal"]]
  package = {gen-soic-pkg(fields)}(for i in 1 through 8 do : p[i] => p[i])
  
pcb-component sop :
  port p : pin[{1 through 8}]
  val fields = [["L-min", 1.95], 
                ["L-max", 2.05], 
                ["W-min", 4.55], 
                ["W-max", 4.65], 
                ["T1-min", 0.15], 
                ["T1-max", 0.35], 
                ["TW1-min", 0.05], 
                ["TW1-max", 0.15], 
                ["THW-min", 3.25],
                ["THW-max", 3.25],
                ["THL-min", 0.45],
                ["THL-max", 0.45],
                ["E-min", 2.95], 
                ["E-max", 3.05], 
                ["H", 0.45], 
                ["H-s", 2.95], 
                ["Pin-n", 8], 
                ["Pad-shape", "rectangular"], 
                ["Pitch", 1.27],
                ["Density", "nominal"]]
  package = {gen-sop-pkg(fields)}(for i in 1 through 8 do : p[i] => p[i])

pcb-component soj :
  port p : pin[{1 through 8}]
  val fields = [["L-min", 1.95], 
                ["L-max", 2.05], 
                ["W-min", 4.55], 
                ["W-max", 4.65], 
                ["T1-min", 0.15], 
                ["T1-max", 0.35], 
                ["TW1-min", 0.05], 
                ["TW1-max", 0.15], 
                ["E-min", 2.95], 
                ["E-max", 3.05], 
                ["H", 0.45], 
                ["H-s", 2.95], 
                ["Pin-n", 8], 
                ["Pad-shape", "rectangular"], 
                ["Pitch", 1.27],
                ["Density", "nominal"]]
  package = {gen-soj-pkg(fields)}(for i in 1 through 8 do : p[i] => p[i])

pcb-component son :
  port p : pin[{1 through 8}]
  val fields = [["L-min", 1.95], 
                ["L-max", 2.05], 
                ["W-min", 4.55], 
                ["W-max", 4.65], 
                ["T1-min", 0.15], 
                ["T1-max", 0.35], 
                ["TW1-min", 0.05], 
                ["TW1-max", 0.15], 
                ["TH1-min", 0.05], 
                ["TH1-max", 0.10], 
                ["H", 0.45], 
                ["H-s", 2.95], 
                ["Pin-n", 8], 
                ["Pitch", 1.27],
                ["Density", "nominal"]]
  package = {gen-son-pkg(fields)}(for i in 1 through 8 do : p[i] => p[i])

pcb-component pson :
  port p : pin[{1 through 8}]
  val fields = [["L-min", 1.95], 
                ["L-max", 2.05], 
                ["W-min", 4.55], 
                ["W-max", 4.65], 
                ["T1-min", 0.15], 
                ["T1-max", 0.35], 
                ["TW1-min", 0.05], 
                ["TW1-max", 0.15], 
                ["TH1-min", 0.05], 
                ["TH1-max", 0.10], 
                ["TPB1-min", 0.01], 
                ["TPB1-max", 0.02], 
                ["H", 0.45], 
                ["H-s", 2.95], 
                ["Pin-n", 8], 
                ["Pitch", 1.27],
                ["Density", "nominal"]]
  package = {gen-pson-pkg(fields)}(for i in 1 through 8 do : p[i] => p[i])

pcb-component chip-array-flat :
  port p : pin[{1 through 8}]
  val fields = [["L-min", 1.95], 
                ["L-max", 2.05], 
                ["W-min", 4.55], 
                ["W-max", 4.65], 
                ["T1-min", 0.15], 
                ["T1-max", 0.35], 
                ["TW1-min", 0.05], 
                ["TW1-max", 0.15], 
                ["H", 0.45], 
                ["Pin-n", 8], 
                ["Pitch", 1.27],
                ["Density", "nominal"],
                ["Hull-type", "flat"],
                ["Pad-shape", "rectangular"]]
  package = {gen-chip-array-pkg(fields)}(for i in 1 through 8 do : p[i] => p[i])

pcb-component chip-array-convexS :
  port p : pin[{1 through 8}]
  val fields = [["L-min", 1.95], 
                ["L-max", 2.05], 
                ["W-min", 4.55], 
                ["W-max", 4.65], 
                ["T1-min", 0.15], 
                ["T1-max", 0.35], 
                ["TW1-min", 0.15], 
                ["TW1-max", 0.25], 
                ["TW2-min", 0.05], 
                ["TW2-max", 0.15], 
                ["H", 0.45], 
                ["Pin-n", 8], 
                ["Pitch", 1.0],
                ["Density", "nominal"],
                ["Hull-type", "convexS"],
                ["Pad-shape", "rectangular"]]
  package = {gen-chip-array-pkg(fields)}(for i in 1 through 8 do : p[i] => p[i])

pcb-component pqfp :
  port p : pin[{1 through 100}]
  val fields = [["L-min", 14.0], 
                ["L-max", 14.0], 
                ["W-min", 20.0], 
                ["W-max", 20.0], 
                ["T1-min", 0.7], 
                ["T1-max", 1.05], 
                ["E1-min", 16.95], 
                ["E1-max", 17.45], 
                ["E2-min", 22.95], 
                ["E2-max", 23.45], 
                ["TW1-min", 0.22], 
                ["TW1-max", 0.38], 
                ["H", 2.45], 
                ["Pins-m", 20], 
                ["Pins-n", 30], 
                ["Pitch", 0.65],
                ["Density", "nominal"],
                ["Pin1-loc", "topleft"],
                ["H-s", 0.25],
                ["Pad-shape", "rectangular"]]
  package = {gen-pqfp-pkg(fields)}(for i in 1 through 100 do : p[i] => p[i])
                                         
pcb-module my-design :
  inst r : {gen-res-cmp(1000.0)}
  inst l : {ocdb/texas-instruments/TPS65988/component}
  inst m : {ocdb/texas-instruments/ISO1540/component} 
  inst chp : chip 
  inst mldd : molded
  inst mlf : melf
  inst ww : wirewound
  inst sdfl : sodfl
  inst dfn2 : dfn-2
  inst dfn3 : dfn-3
  inst dfn4 : dfn-4
  inst soic : soic
  inst sop : sop
  inst soj : soj
  inst son : son
  inst pson : pson
  inst chip-array-flat : chip-array-flat
  inst chip-array-convexS : chip-array-convexS
  inst pqfp : pqfp
  ;inst t : {ocdb/wurth/691412320002M/component}
  

val main-design = default-board(my-design, 4, 100.0, 75.0)

;view(test)
view(main-design)